<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>whislist</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="wishlist-container"></div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const container = document.getElementById('wishlist-container');

  // Fetch items from backend
  fetch('/api/wishlist')
    .then(res => res.json())
    .then(items => {
      container.innerHTML = ''; // clear

      items.forEach(item => {
        const div = document.createElement('div');
        div.classList.add('wishlist-item');

        div.innerHTML = `
          <img src="${item.image}" alt="${item.title}" width="150">
          <h3>${item.title}</h3>
          <p>Price: â‚¹${item.price}</p>
          <a href="${item.link}" target="_blank"><button>Shop Now</button></a>
          <button class="remove-btn" data-id="${item._id}">Remove</button>
          <hr>
        `;

        // attach event to remove button
        div.querySelector('.remove-btn').addEventListener('click', () => {
          const id = div.querySelector('.remove-btn').dataset.id;

          // call DELETE API
          fetch(`/api/wishlist/${id}`, {
            method: 'DELETE'
          })
          .then(res => res.json())
          .then(data => {
            console.log(data);
            // remove from DOM after deletion
            div.remove();
          })
          .catch(err => console.error(err));
        });

        container.appendChild(div);
      });
    })
    .catch(err => console.error(err));
});
</script>

<script src="wishlist.js"></script>
</body>
</html>
